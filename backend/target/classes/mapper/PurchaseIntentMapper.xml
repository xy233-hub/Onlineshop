<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.onlineshop.mapper.PurchaseIntentMapper">

    <resultMap id="PurchaseIntentMap" type="com.example.onlineshop.entity.PurchaseIntent">
        <id property="purchase_id" column="purchase_id"/>
        <result property="product_id" column="product_id"/>
        <result property="customer_name" column="customer_name"/>
        <result property="customer_phone" column="customer_phone"/>
        <result property="customer_address" column="customer_address"/>
        <result property="purchase_status" column="purchase_status"/>
        <result property="created_at" column="created_at"/>
        <result property="updated_at" column="updated_at"/>
    </resultMap>

    <insert id="insert" parameterType="com.example.onlineshop.entity.PurchaseIntent" useGeneratedKeys="true" keyProperty="purchase_id">
        INSERT INTO purchase_intents(product_id, customer_name, customer_phone, customer_address, purchase_status)
        VALUES(#{product_id}, #{customer_name}, #{customer_phone}, #{customer_address}, #{purchase_status})
    </insert>

    <select id="findByProductId" parameterType="int" resultMap="PurchaseIntentMap">
        SELECT * FROM purchase_intents WHERE product_id = #{productId}
    </select>

    <select id="findById" parameterType="int" resultMap="PurchaseIntentMap">
        SELECT * FROM purchase_intents WHERE purchase_id = #{purchaseId}
    </select>

    <update id="updateStatus">
        UPDATE purchase_intents SET purchase_status = #{status} WHERE purchase_id = #{purchaseId}
    </update>

    <select id="findAll" resultMap="PurchaseIntentMap">
        SELECT * FROM purchase_intents
    </select>
</mapper>