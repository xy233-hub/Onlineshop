以下是统一格式后的接口文档，保持内容不变，统一了结构、描述方式及呈现逻辑：


### 通用说明
所有接口响应均采用统一封装格式：
```text
{
  "code": Number,        // 状态码（200 成功）
  "message": String,     // 提示信息
  "data": Object | Array | null  // 返回数据
}
```


### 1. 商品列表查询
- **方法**：GET
- **路径**：`/api/products`
- **描述**：查询商品列表，支持关键词、分类、状态、分页、排序等筛选（GET请求无请求体，参数通过查询字符串传递）
- **权限**：公开
- **查询参数**：
```text
{
  "q": String (可选),           // 关键词
  "category_id": Number (可选),
  "status": String (可选, "online"|"frozen"|"sold"|"outOfStock"),
  "page": Number (可选, 默认 1),
  "size": Number (可选, 默认 10),
  "sort_by": String (可选, 如 "price"|"created_at"),
  "order": String (可选, "asc"|"desc")
}
```
- **响应示例（data部分）**：
```text
{
  "page": Number,
  "size": Number,
  "total": Number,
  "items": [
    {
      "product_id": Number,
      "seller_id": Number,
      "category_id": Number,
      "product_name": String,
      "product_desc": String,            // 富媒体 HTML 或 Markdown
      "images": [ String ],              // 图片 URL 列表
      "price": Number,
      "stock_quantity": Number,
      "product_status": String,
      "search_keywords": String (可选),
      "created_at": String,
      "updated_at": String
    }
  ]
}
```


### 2. 单个商品详情查询
- **方法**：GET
- **路径**：`/api/products/{product_id}`
- **描述**：查询单个商品的详细信息（含图片、媒体、分类等）
- **权限**：公开
- **响应示例（data部分）**：
```text
{
  "product_id": Number,
  "seller_id": Number,
  "category_id": Number,
  "product_name": String,
  "product_desc": String,
  "images": [
    { "image_id": Number, "image_url": String, "image_order": Number }
  ],
  "media_resources": [
    { "media_id": Number, "media_type": String, "media_url": String, "file_name": String }
  ],
  "price": Number,
  "stock_quantity": Number,
  "product_status": String,
  "search_keywords": String (可选),
  "category": { "category_id": Number, "parent_id": Number | null, "category_name": String },
  "created_at": String,
  "updated_at": String
}
```


### 3. 提交购买意向（下单）
- **方法**：POST
- **路径**：`/api/products/purchase-intents`
- **描述**：登录客户提交购买意向，填写商品、数量、联系方式等
- **权限**：登录客户（需Authorization令牌）
- **请求体（JSON）**：
```text
{
  "product_id": Number,
  "quantity": Number,                    // 可选，默认 1
  "customer_id": Number,                 // 必填，必须与Authorization中的用户一致
  "customer_name": String (可选),         // 可选，若不传使用客户注册信息
  "customer_phone": String (可选),        // 可选，若不传使用客户注册信息
  "customer_address": String (可选),     // 可选，若不传使用客户默认地址
  "note": String (可选)
}
```
- **响应示例（data部分）**：
```text
{
  "purchase_id": Number,
  "product_id": Number,
  "customer_id": Number,
  "quantity": Number,
  "unit_price": Number,
  "total_amount": Number,
  "purchase_status": String,   // "pending"
  "contact_name": String,
  "contact_phone": String,
  "delivery_address": String,
  "seller_notes": String | null,
  "created_at": String,
  "updated_at": String
}
```


### 4. 客户注册
- **方法**：POST
- **路径**：`/api/customers/register`
- **描述**：客户注册账号，需填写用户名、密码、手机号等信息
- **权限**：公开
- **请求体（JSON）**：
```text
{
  "username": String,          // 6-20 位
  "password": String,
  "phone": String,
  "default_address": String (可选)
}
```
- **响应示例（data部分）**：
```text
{
  "token": String,
  "customer_info": {
    "customer_id": Number,
    "username": String,
    "phone": String,
    "default_address": String | null,
    "created_at": String,
    "updated_at": String
  }
}
```


### 5. 客户登录
- **方法**：POST
- **路径**：`/api/customers/login`
- **描述**：客户登录，返回令牌（token）和客户信息
- **权限**：公开
- **请求体（JSON）**：
```text
{
  "username": String,
  "password": String
}
```
- **响应示例（data部分）**：
```text
{
  "token": String,
  "customer_info": {
    "customer_id": Number,
    "username": String,
    "phone": String,
    "default_address": String | null,
    "created_at": String,
    "updated_at": String
  }
}
```


### 6. 客户查询自己的购买意向记录
- **方法**：GET
- **路径**：`/api/customers/{customer_id}/purchase-intents`
- **描述**：查询客户自己的购买意向记录，支持分页和状态筛选
- **权限**：登录客户（需Authorization令牌，仅限本人查询）
- **查询参数**：
```text
{
  "page": Number (可选, 默认 1),
  "size": Number (可选, 默认 10),
  "purchase_status": String (可选)
}
```
- **响应示例（data部分）**：
```text
{
  "page": Number,
  "size": Number,
  "total": Number,
  "items": [
    {
      "purchase_id": Number,
      "product_id": Number,
      "quantity": Number,
      "total_amount": Number,
      "purchase_status": String,
      "seller_notes": String | null,
      "created_at": String,
      "updated_at": String
    }
  ]
}
```


### 7. 卖家登录
- **方法**：POST
- **路径**：`/api/seller/login`
- **描述**：卖家登录，返回令牌（token）和卖家信息
- **权限**：公开
- **请求体（JSON）**：
```text
{
  "username": String,
  "password": String
}
```
- **响应示例（data部分）**：
```text
{
  "token": String,
  "seller_info": {
    "seller_id": Number,
    "username": String,
    "create_time": String
  }
}
```


### 8. 卖家发布商品
- **方法**：POST
- **路径**：`/api/seller/products`
- **描述**：卖家发布商品，支持multipart/form-data或JSON格式（引用已上传URL）
- **权限**：卖家（需Authorization令牌）
- **请求体（JSON）**：
```text
{
  "product_name": "String (必填)",                // 与 products.product_name NOT NULL
  "product_desc": "String (必填)",                // 与 products.product_desc NOT NULL（富媒体 HTML/Markdown）
  "category_id": "Number (必填)",                 // 与 products.category_id NOT NULL，必须是存在的二级分类
  "price": "Number (必填, >=0)",                  // products.price NOT NULL
  "stock_quantity": "Number (可选, 默认 0)",       // products.stock_quantity NOT NULL DEFAULT 0
  "search_keywords": "String (可选)",             // products.search_keywords 可空
  "images": [                                     
    { "temp_key": "String"},
    {"image_url": "String ", "image_order": "Number (可选, 默认 0)" }
  ] (可选),                                       // 写入 product_images 表
  "media_resources": [
    { "temp_key": "String"},
    { "media_type": "String (可选, 'image'|'video'|'audio', 默认 'image')",
      "media_url": "String (必填)",
      "file_name": "String (必填)",
      "file_size": "Number (必填)",
      "mime_type": "String (必填)",
      "display_order": "Number (可选, 默认 0)",
      "is_embedded": "Boolean (可选, 默认 false)"
    }
  ] (可选)                                        // 写入 media_resources 表
}
```
- **响应示例（data部分）**：
```text
{
  "product_id": Number,
  "product_status": String,   // "online" 或 "outOfStock"
  "created_at": String,
  "updated_at": String
}
```


### 9. 卖家查询自己发布的商品列表
- **方法**：GET
- **路径**：`/api/seller/products`
- **描述**：卖家查询自己发布的商品列表，支持筛选和分页
- **权限**：卖家（需Authorization令牌）
- **查询参数**：
```text
{
  "status": String (可选),
  "page": Number (可选),
  "size": Number (可选)
}
```
- **响应示例（data部分）**：与通用商品列表响应格式一致（含历史记录）


### 10. 卖家冻结（下架）商品
- **方法**：PUT
- **路径**：`/api/seller/products/{product_id}/freeze`
- **描述**：卖家冻结（下架）某个商品，可填写原因
- **权限**：卖家（需Authorization令牌，仅限自己发布的商品）
- **请求体（JSON）**：
```text
{
  "reason": String (可选)
}
```
- **响应示例（data部分）**：
```text
{
  "product_id": Number,
  "product_status": String,   // "frozen"
  "updated_at": String
}
```


### 11. 卖家解冻（重新上架）商品
- **方法**：PUT
- **路径**：`/api/seller/products/{product_id}/unfreeze`
- **描述**：卖家解冻（重新上架）商品，可填写备注
- **权限**：卖家（需Authorization令牌，仅限自己发布的商品）
- **请求体（JSON）**：
```text
{
  "remark": String (可选)
}
```
- **响应示例（data部分）**：
```text
{
  "product_id": Number,
  "product_status": String,   // "online" 或 "outOfStock"（取决于库存）
  "updated_at": String
}
```


### 12. 卖家标记商品为已售出
- **方法**：PUT
- **路径**：`/api/seller/products/{product_id}/mark-sold`
- **描述**：卖家标记商品为已售出，更新库存和状态
- **权限**：卖家（需Authorization令牌，仅限自己发布的商品）
- **请求体（JSON）**：
```text
{
  "sold_quantity": Number (可选, 默认为 1),
  "note": String (可选)
}
```
- **响应示例（data部分）**：
```text
{
  "product_id": Number,
  "product_status": String,   // 可能为 "sold" 或 "outOfStock"
  "stock_quantity": Number,
  "updated_at": String
}
```


### 13. 卖家查询收到的购买意向
- **方法**：GET
- **路径**：`/api/seller/purchase-intents`
- **描述**：卖家查询收到的所有购买意向，支持筛选和分页
- **权限**：卖家（需Authorization令牌）
- **查询参数**：
```text
{
  "purchase_status": String (可选),
  "product_id": Number (可选),
  "page": Number (可选),
  "size": Number (可选)
}
```
- **响应示例（data部分）**：
```text
{
  "page": Number,
  "size": Number,
  "total": Number,
  "items": [
    {
      "purchase_id": Number,
      "product_id": Number,
      "customer_id": Number | null,
      "customer_name": String,
      "customer_phone": String,
      "customer_address": String,
      "quantity": Number,
      "total_amount": Number,
      "purchase_status": String,
      "seller_notes": String | null,
      "created_at": String,
      "updated_at": String
    }
  ]
}
```


### 14. 卖家处理购买意向
- **方法**：PUT
- **路径**：`/api/seller/purchase-intents/{purchase_id}/status`
- **描述**：卖家处理购买意向，修改其状态（如成功、失败）并备注
- **权限**：卖家（需Authorization令牌）
- **请求体（JSON）**：
```text
{
  "new_status": String,   // "success" | "failed"
  "seller_notes": String (可选)
}
```
- **响应示例（data部分）**：
```text
{
  "purchase_id": Number,
  "product_id": Number,
  "customer_id": Number | null,
  "quantity": Number,
  "total_amount": Number,
  "purchase_status": String,
  "seller_notes": String | null,
  "created_at": String,
  "updated_at": String
}
```


### 15. 卖家查询所有客户信息
- **方法**：GET
- **路径**：`/api/seller/customers`
- **描述**：卖家查询所有客户信息，支持分页，可带最近购买记录
- **权限**：卖家（需Authorization令牌）
- **查询参数**：
```text
{
  "page": Number (可选),
  "size": Number (可选)
}
```
- **响应示例（data部分）**：
```text
{
  "page": Number,
  "size": Number,
  "total": Number,
  "items": [
    {
      "customer_id": Number,
      "username": String,
      "phone": String,
      "default_address": String | null,
      "created_at": String,
      "updated_at": String,
      "recent_purchases": [
        { "purchase_id": Number, "product_id": Number, "total_amount": Number, "created_at": String }
      ] (可选)
    }
  ]
}
```


### 16. 卖家修改密码
- **方法**：PUT
- **路径**：`/api/seller/password`
- **描述**：卖家修改自己的登录密码
- **权限**：卖家（需Authorization令牌）
- **请求体（JSON）**：
```text
{
  "old_password": String,
  "new_password": String
}
```
- **响应示例（data部分）**：`null`（仅返回code和message）


### 17. 媒体资源上传
- **方法**：POST
- **路径**：`/api/media/upload`
- **描述**：上传媒体资源（图片、视频等），写入media_resources表以关联商品（需提供product_id）
- **权限**：卖家（需Authorization令牌）
- **请求体（multipart/form-data）**：
    - `file`：文件二进制（必填）
    - `purpose` (string)：可选，默认`gallery`。取值：
        - `gallery`：作为商品图片，插入到product_images
        - `embedded`：作为富媒体嵌入资源，插入到media_resources
- **响应示例（data部分）**：
```text
{
  "temp_key": "b3569547-a31e-4d98-8688-ef8089f29a88",
  "media_url": "http://localhost:8080/media/temp/b3569547-a31e-4d98-8688-ef8089f29a88.jpg",
  "file_size": 840749,
  "mime_type": "image/jpeg",
  "purpose": "embedded" 
}
```


### 18. 商品类别管理
#### 18.1 公开接口（用户/前端查询）
##### 18.1.1 获取类别列表（树形或扁平）
- **方法**：GET
- **路径**：`/api/categories`
- **描述**：供前端/用户查看类别树或扁平列表，支持筛选和分页
- **权限**：公开
- **查询参数**：
```text
{
  "tree": "true|false (可选, 默认 true)",
  "parent_id": Number (可选),
  "level": Number (可选, 1 或 2),
  "q": String (可选),
  "page": Number (可选, 默认 1),
  "size": Number (可选, 默认 50),
  "sort_by": "created_at|category_name" (可选),
  "order": "asc|desc" (可选)
}
```
- **响应示例**：tree=true时返回树形数组；tree=false时返回分页扁平结构


##### 18.1.2 查询单个类别详情
- **方法**：GET
- **路径**：`/api/categories/{category_id}`
- **描述**：查询单个类别的详细信息
- **权限**：公开
- **响应示例**：类别详情（含ID、名称、父ID、层级等）


#### 18.2 管理接口（卖家/有权限用户操作）
##### 18.2.1 获取分类列表（扁平）
- **方法**：GET
- **路径**：`/api/seller/categories`
- **描述**：获取分类的扁平列表（含分页）
- **权限**：卖家/管理员（需Authorization令牌）
- **查询参数**：与18.1.1一致
- **响应示例**：分页扁平结构（同18.1.1 tree=false时格式）


##### 18.2.2 获取分类树（层级）
- **方法**：GET
- **路径**：`/api/seller/categories/tree`
- **描述**：获取分类的树形层级结构
- **权限**：卖家/管理员（需Authorization令牌）
- **响应示例**：树形数组（同18.1.1 tree=true时格式）


##### 18.2.3 查询单个分类详情
- **方法**：GET
- **路径**：`/api/seller/categories/{category_id}`
- **描述**：查询单个分类的详细信息
- **权限**：卖家/管理员（需Authorization令牌）
- **响应示例**：分类详情（含ID、名称、父ID、层级等）


##### 18.2.4 新建分类
- **方法**：POST
- **路径**：`/api/seller/categories`
- **描述**：创建新分类（最大层级为2，商品上架需关联二级分类）
- **权限**：卖家/管理员（需Authorization令牌）
- **请求体（JSON）**：
```text
{
  "parent_id": Number | null,
  "category_name": "String"
}
```
- **响应示例（data部分）**：新建后的分类记录（含category_id、category_level、created_at等）


##### 18.2.5 更新分类
- **方法**：PUT
- **路径**：`/api/seller/categories/{category_id}`
- **描述**：更新分类信息
- **权限**：卖家/管理员（需Authorization令牌）
- **请求体（JSON）**：与18.2.4一致
- **响应示例（data部分）**：更新后的分类记录（含updated_at）


##### 18.2.6 删除分类
- **方法**：DELETE
- **路径**：`/api/seller/categories/{category_id}`
- **描述**：删除分类（仅当无子分类且无商品引用时允许）
- **权限**：卖家/管理员（需Authorization令牌）
- **响应示例（data部分）**：`null`（删除失败时message说明原因，如“存在子分类”或“存在商品引用”）


##### 18.2.7 移动/重设父分类或排序
- **方法**：PATCH
- **路径**：`/api/seller/categories/{category_id}/move`
- **描述**：调整分类的父分类或排序
- **权限**：卖家/管理员（需Authorization令牌）
- **请求体（JSON）**：
```text
{
  "new_parent_id": Number | null,
  "new_order": Number | null
}
```
- **响应示例（data部分）**：更新后的分类记录


### 19. 卖家查看顾客购买历史
- **方法**：GET
- **路径**：`/api/seller/customers/{customer_id}/purchase-history`
- **描述**：卖家查询指定顾客的购买历史记录
- **权限**：卖家（需Authorization令牌）
- **响应示例（data部分）**：
```text
{
  "purchase_history": [
    {
      "purchase_id": 5,
      "product_id": 4,
      "customer_id": 2,
      "customer_name": "xy233",
      "customer_phone": "12345678910",
      "customer_address": "zhejiang",
      "quantity": 1,
      "total_amount": 299.99,
      "purchase_status": "success",
      "seller_notes": null,
      "created_at": "2025-10-30T13:42:44",
      "updated_at": "2025-11-03T00:58:23"
    }
  ],
  "customer_info": {
    "customer_id": 2,
    "username": "xy2333",
    "phone": "12345678910",
    "default_address": "zhejiang",
    "created_at": "2025-10-30T12:56:45",
    "updated_at": "2025-10-30T12:56:45"
  }
}
```

#### 20. 客户添加商品到收藏夹（Favorite）
- **方法**：POST
- **路径**：`/api/customers/favorites`
- **描述**：客户收藏指定商品，同一客户对同一商品仅允许单次收藏（重复收藏返回成功提示，不重复创建）；购物车转收藏接口内部复用此接口的核心校验与创建逻辑
- **权限**：登录客户（需Authorization令牌）
- **请求体（JSON）**：
```text
{
  "customer_id": Number (必填),                 // 必须与Authorization中的用户一致
  "product_id": Number (必填)                   // 需为状态为"online"的商品
}
```
- **响应示例（data部分）**：
```text
{
  "favorite_id": Number,
  "customer_id": Number,
  "product_id": Number,
  "product_info": {
    "product_name": String,
    "product_desc": String,
    "price": Number,
    "image_url": String                         // 商品首图URL
  },
  "favorited_at": String
}
```


#### 21. 客户添加商品到购物车（支持单商品/批量）
- **方法**：POST
- **路径**：`/api/customers/cart/items`
- **描述**：支持单商品添加或批量添加商品到购物车，同一客户对同一商品重复添加时数量累加；批量添加时返回每个商品的添加结果（成功/失败原因）
- **权限**：登录客户（需Authorization令牌）
- **请求体（JSON）**：
```text
{
  "customer_id": Number (必填),                 // 必须与Authorization中的用户一致
  "items": [                                    // 商品列表（至少1个，支持单商品/多商品）
    {
      "product_id": Number (必填),               // 需为状态为"online"的商品
      "quantity": Number (可选, 默认 1, 最小值 1),// 购买数量，不可超过商品库存
      "note": String (可选)                      // 该商品的购物车备注
    }
  ]
}
```
- **单商品请求示例**（兼容原有场景）：
```text
{
  "customer_id": 1001,
  "items": [{"product_id": 2001, "quantity": 2, "note": "要红色"}]
}
```
- **批量商品请求示例**：
```text
{
  "customer_id": 1001,
  "items": [
    {"product_id": 2001, "quantity": 2},
    {"product_id": 2002, "quantity": 1, "note": "尽快发货"}
  ]
}
```
- **响应示例（data部分）**：
```text
{
  "success_count": Number,                      // 成功添加的商品数量
  "failed_count": Number,                       // 添加失败的商品数量
  "success_items": [                            // 成功添加的购物车项
    {
      "cart_item_id": Number,
      "product_id": Number,
      "product_name": String,
      "quantity": Number,
      "unit_price": Number,
      "note": String | null,
      "created_at": String
    }
  ],
  "failed_items": [                             // 添加失败的商品（无失败则为空数组）
    {
      "product_id": Number,
      "reason": String                          // 失败原因（如"商品库存不足"、"商品已下架"）
    }
  ]
}
```


### 22. 客户从购物车选择多件商品下单
- **方法**：POST
- **路径**：`/api/customers/cart/batch-purchase`
- **描述**：客户选择购物车中多个商品统一下单，下单成功后对应购物车项自动删除；支持部分商品下单失败时返回失败原因（如库存不足）
- **权限**：登录客户（需Authorization令牌）
- **请求体（JSON）**：
```text
{
  "customer_id": Number (必填),                 // 必须与Authorization中的用户一致
  "cart_item_ids": [Number] (必填),              // 购物车项ID数组（至少1个）
  "contact_name": String (可选),                 // 可选，若不传使用客户注册姓名
  "contact_phone": String (可选),                // 可选，若不传使用客户注册手机号
  "delivery_address": String (可选),             // 可选，若不传使用客户默认地址
  "note": String (可选)                          // 订单备注
}
```
- **响应示例（data部分）**：
```text
{
  "order_id": Number,
  "customer_id": Number,
  "total_amount": Number,
  "order_status": String,                       // "pending"（待处理）
  "contact_name": String,
  "contact_phone": String,
  "delivery_address": String,
  "note": String | null,
  "items": [
    {
      "product_id": Number,
      "product_name": String,
      "quantity": Number,
      "unit_price": Number,
      "subtotal": Number
    }
  ],
  "failed_items": [                             // 下单失败的商品（无失败则为空数组）
    {
      "cart_item_id": Number,
      "product_id": Number,
      "product_name": String,
      "reason": String                          // 失败原因（如"商品已下架"）
    }
  ],
  "created_at": String,
  "updated_at": String
}
```


#### 23. 客户从购物车选择多件商品转为收藏（Favorite）
- **方法**：POST
- **路径**：`/api/customers/cart/batch-convert-favorite`
- **描述**：客户将购物车中多个商品转为收藏，内部复用“添加收藏”接口的核心逻辑；转换成功后对应购物车项自动删除；已收藏的商品仍可转换（不重复创建，仅删除购物车项）
- **权限**：登录客户（需Authorization令牌）
- **请求体（JSON）**：
```text
{
  "customer_id": Number (必填),                 // 必须与Authorization中的用户一致
  "cart_item_ids": [Number] (必填)               // 购物车项ID数组（至少1个）
}
```
- **响应示例（data部分）**：
```text
{
  "converted_count": Number,                    // 成功转换的数量
  "failed_count": Number,                       // 转换失败的数量
  "converted_favorites": [
    {
      "favorite_id": Number,
      "product_id": Number,
      "product_name": String,
      "favorited_at": String
    }
  ],
  "failed_items": [                             // 转换失败的购物车项（无失败则为空数组）
    {
      "cart_item_id": Number,
      "product_id": Number,
      "product_name": String,
      "reason": String                          // 失败原因（如"商品已下架"）
    }
  ],
  "deleted_cart_item_ids": [Number]             // 已删除的购物车项ID
}
```


#### 24. 客户查询收藏列表（Favorite）（保持不变）
- **方法**：GET
- **路径**：`/api/customers/favorites`
- **描述**：客户查询自己的所有收藏商品，支持分页筛选
- **权限**：登录客户（需Authorization令牌）
- **查询参数**：
```text
{
  "customer_id": Number (必填),                 // 必须与Authorization中的用户一致
  "page": Number (可选, 默认 1),
  "size": Number (可选, 默认 10),
  "sort_by": String (可选, 如 "favorited_at"),
  "order": String (可选, "asc"|"desc")
}
```
- **响应示例（data部分）**：
```text
{
  "page": Number,
  "size": Number,
  "total": Number,
  "items": [
    {
      "favorite_id": Number,
      "product_id": Number,
      "product_info": {
        "product_name": String,
        "product_desc": String,
        "price": Number,
        "image_url": String,
        "stock_quantity": Number,
        "product_status": String
      },
      "created_at": String
    }
  ]
}
```

#### 25. 客户取消收藏（Favorite）（保持不变）
- **方法**：DELETE
- **路径**：`/api/customers/favorites/{favorite_id}`
- **描述**：客户取消对指定商品的收藏，删除对应收藏记录
- **权限**：登录客户（需Authorization令牌，仅限本人收藏记录）
- **响应示例（data部分）**：
```text
{
  "favorite_id": Number,
  "customer_id": Number,
  "message": "取消收藏成功",
  "updated_at": String
}
```

完全正确！购物车功能需要配套的“查询购物车列表”和“删除购物车项”接口才能形成完整闭环，下面补充这两个核心接口，严格遵循之前的统一格式规范，与现有接口逻辑保持一致：

### 26. 客户查询购物车列表
- **方法**：GET
- **路径**：`/api/customers/cart/items`
- **描述**：客户查询自己的购物车所有商品，支持分页、筛选（如仅显示库存充足商品），返回商品当前状态（确保下单前信息准确）
- **权限**：登录客户（需Authorization令牌）
- **查询参数**：
```text
{
  "customer_id": Number (必填),                 // 必须与Authorization中的用户一致
  "page": Number (可选, 默认 1),
  "size": Number (可选, 默认 10),
  "filter_stock": Boolean (可选, 默认 false),   // 是否仅显示库存充足商品（true=仅显示，false=全部显示）
  "sort_by": String (可选, 如 "created_at"|"price"),
  "order": String (可选, "asc"|"desc")
}
```
- **响应示例（data部分）**：
```text
{
  "page": Number,
  "size": Number,
  "total": Number,                              // 购物车商品总数量
  "total_amount": Number,                       // 购物车所有商品总价（按当前单价计算）
  "items": [
    {
      "cart_item_id": Number,
      "product_id": Number,
      "product_info": {
        "product_name": String,
        "product_desc": String,
        "price": Number,                        // 商品当前单价（可能与加入时不同）
        "stock_quantity": Number,               // 商品当前库存
        "image_url": String,
        "product_status": String                // 商品当前状态（online/outOfStock/frozen/sold）
      },
      "quantity": Number,
      "unit_price": Number,                     // 商品加入购物车时的单价（参考用）
      "subtotal": Number,                       // 该商品小计（当前单价 × 数量）
      "note": String | null,
      "created_at": String,
      "updated_at": String,
      "stock_enough": Boolean                   // 是否库存充足（方便前端提示）
    }
  ]
}
```


### 27. 客户删除购物车项（支持单个/批量）
- **方法**：DELETE
- **路径**：`/api/customers/cart/items`
- **描述**：客户删除购物车中单个或多个商品，支持批量操作，删除前校验购物车项是否存在（仅能删除本人的购物车项）
- **权限**：登录客户（需Authorization令牌）
- **请求体（JSON）**：（注：DELETE方法支持请求体，兼容多端调用；若部分端不支持，可改为查询参数，但请求体更适合传递数组）
```text
{
  "customer_id": Number (必填),                 // 必须与Authorization中的用户一致
  "cart_item_ids": [Number] (必填)               // 购物车项ID数组（至少1个，支持单个/多个）
}
```
- **单个删除请求示例**：
```text
{
  "customer_id": 1001,
  "cart_item_ids": [3001]
}
```
- **批量删除请求示例**：
```text
{
  "customer_id": 1001,
  "cart_item_ids": [3001, 3002, 3003]
}
```
- **响应示例（data部分）**：
```text
{
  "deleted_count": Number,                      // 成功删除的购物车项数量
  "failed_count": Number,                       // 删除失败的数量
  "deleted_cart_item_ids": [Number],            // 成功删除的购物车项ID
  "failed_items": [                             // 删除失败的项（无失败则为空数组）
    {
      "cart_item_id": Number,
      "reason": String                          // 失败原因（如"购物车项不存在"、"无权限删除"）
    }
  ]
}
```
### 28： 客户取消订单

- 方法： POST

- 路径：`/api/customers/{customer_id}/purchase-intents/{purchase_id}/cancel`

- 权限：客户（需 `Authorization: Bearer <token>`）

  ```json
  {
    "code": 200,
    "message": "订单取消成功",
    "data": {
      "purchase_id": 5,
      "product_id": 4,
      "customer_id": 2,
      "quantity": 1,
      "total_amount": 299.99,
      "purchase_status": "CUSTOMER_CANCELLED",
      "cancel_reason": "不想要了",
      "cancel_notes": "已找到更合适的商品",
      "created_at": "2025-10-30T13:42:44",
      "updated_at": "2025-11-03T00:58:23"
    }
  }
  ```

  请求体示例：

  ```json
    {
      "cancel_reason": "不想要了",
      "cancel_notes": "已找到更合适的商品"
    }
  ```

### 29： 客户确认收货

- 方法：POST

- 路径：`/api/customers/{customer_id}/purchase-intents/{purchase_id}/confirm-received`

- 权限：客户（需 `Authorization: Bearer <token>`）

- 请求体：无

  ```json
  {
    "code": 200,
    "message": "确认收货成功",
    "data": {
      "purchase_id": 5,
      "product_id": 4,
      "customer_id": 2,
      "quantity": 1,
      "total_amount": 299.99,
      "purchase_status": "COMPLETED",
      "created_at": "2025-10-30T13:42:44",
      "updated_at": "2025-11-03T00:58:23"
    }
  }
  ```

### 统一错误响应格式
```text
{ "code": 400, "message": "错误原因说明（如：库存不足）", "data": null }
```